
<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <link href="../../css/mui.css" rel="stylesheet" />
    <link href="../../css/gloab.css" rel="stylesheet" />
    <link href="../../css/xmui.pullToRefresh.material.css" rel="stylesheet" />
    <link href="../../css/swiper.min.css" rel="stylesheet">
    <style>
        .swiper-slide{
            width: 100px;
        }
        input[type=radio][name=type-choice]{
            display: none;
            opacity: 0;
        }

        input[type=radio][name=type-choice]+label {
            font-size: 14px;
            display: inline-block;
            width: 100%;
            text-align: center;
            line-height: 34px;
        }

        input[type=radio][name=type-choice]:checked+label {
            border-bottom: 1px solid #FE7E00;
            color: #FE7E00;
        }
        .bg-title{
            background-color:#c70321;
        }
        .my-swiper{
            background-color: white;
            height: 35px;
        }
        /*jQuery18307202219375663517_1520487900851*/
        .cell-ji{
            text-align: center;
            background-color: #ffffff;
        }
        .cell-ou{
            text-align: center;
            background-color: #F9F9F9;

        }
       
		.mui-pull-bottom-tips {
			display: none !important;
		}
    </style>

</head>
<body>
<header class="mui-bar mui-bar-nav bg-title">
    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left color-white"></a>
    <h1 class="mui-title color-white titlecolor">我的定投计划</h1>
</header>

<div class="mui-content mui-scroll-wrapper" >
    <div class="mui-scroll" id="station-list" style="padding-bottom: 50px;">
    	
    	
    	
    	<div id="vue-body">

			<template v-if="(fundslist==null||fundslist.length==0)&&isLoad==1">
				<div style="text-align: center;font-size: 16px;margin-top: 30px;">
					- - 暂未查到相关信息 - -
				</div>
			</template>
    		<template v-for="(item,index) in fundslist">
	    		<!--单个预定 div start-->
				<div class="bg-bai wd100 div-ding" :trade_acco="fundslist[index].trade_acco" :scheduled_protocol_id="fundslist[index].scheduled_protocol_id" style="margin-top: 5px;padding-bottom: 10px;">
					<div class="dis_table wd90 pt15 pb15">
						<div class="dis_table_cell textleft" style="font-size: 14px;color: #000000;padding: 10px 0px;" v-text="fundslist[index].fund_name+' ('+fundslist[index].fund_code+')'"></div>
						<div class="dis_table_cell wd20" style="font-size: 14px;color: #FB5C5F;padding: 10px 0px;" v-text="getFixStateName(fundslist[index].fix_state)"></div>
					</div>
					<div style="border-bottom: 1px solid #EEEEEE;transform: rotateZ(0.5);"></div>
					<div class="dis_table wd90 pt15 pb15 mt10">
						<div class="dis_table_cell textleft ft14" style="color: #999999;">定投金额</div>
						<div class="dis_table_cell textleft ft14" style="color: #999999;">扣款日期</div>
						<div class="dis_table_cell textleft ft14" style="color: #999999;">下次扣款</div>
					</div>
					<div class="dis_table wd90 pt15 pb15 mt10">
						<div class="dis_table_cell textleft ft14" style="color: #FB7578;" v-text="fundslist[index].balance"></div>
						<div class="dis_table_cell textleft ft16" style="color: #000000;" v-text="getProtocolPeriodName(fundslist[index].protocol_period_unit,fundslist[index].protocol_fix_day)"></div>
						<div class="dis_table_cell textleft ft16" style="color: #000000;" v-text="getFormartDate(fundslist[index].next_fixrequest_date)"></div>
					</div>

				</div>
		    	<!--单个预定 div end-->
    		</template>
    	</div>
    	
    	
    	
    	
    </div>
</div>


<script src="../../js/h.min.js"></script>
		<script src="../../js/mui.min.js"></script>
		<script src="../../js/immersed.js"></script>
<script src="../../js/com.js"></script>
<script src="../../js/xmui-globalEvent.js"></script>
<script src="../../js/mui.pullToRefresh.js"></script>
<script src="../../js/mui.pullToRefresh.material.js"></script>
<script src="../../js/com.js"></script>
<script src="../../js/swiper.min.js"></script>
<script src="../../js/com.data.js"></script>
<script src="../../js/com.mui.js"></script>

<script src="../../js/vue.js"></script>
<script src="../../js/jquery.min_1.8.3.js"></script>
<script src="../../js/md5.js"></script>
<script src="../../js/fundsfunction.js"></script>
<script>
    mui.ready(function () {
        mui(".mui-scroll-wrapper").scroll({
            bounce: true,//是否启用回弹
            indicators: true,//是否显示滚动条
            deceleration:  0.0005 //flick 减速系数，系数越大，滚动速度越慢，滚动距离越小，默认值0.0006
        });
    });
    var scroll;
    
    mui.ge.addListener("DingTouReload", function(args) {
//        scroll.refresh();
        location.reload()
        mui.ge.callback(args, {})
    });

    var vue_body = new Vue({
        el:"#vue-body",
        data:{
            fund_code:"",
			fundslist:[],
            isLoad:0
        },
        methods:{
            getFixStateName:function(bank_no){
                return getFixStateName(bank_no);
            },
            getProtocolPeriodName:function(protocol_period_unit,protocol_fix_day){
                return getProtocolPeriodName(protocol_period_unit,protocol_fix_day)
            },
            getFormartDate:function(date){
            	if(!date){
            		return ""
            	}
                return date.substring(0,4)+"-"+date.substring(4,6)+"-"+date.substring(6,8);
            },
        },
        watch:{

        },
        mounted:function(){

        }
    });

//      fundslist:{
//              "balance": "20.01", 
//              "bank_account": "6226621234567890", 
//              "bank_no": "009", 
//              "branch_centercode": "0001", 
//              "broker": "", 
//              "busin_ass_code": "", 
//              "busin_board_type": "", 
//              "capital_mode": "3", 
//              "charge_permitnum": "0", 
//              "client_id": "1468", 
//              "cust_portfolio_code": "", 
//              "detail_fund_way": "01", 
//              "discount_rate": "1.0000", 
//              "end_flag": "", 
//              "error_code": "", 
//              "error_info": "", 
//              "expiry_date": "20301130", 
//              "exponent_type": "", 
//              "extends_day": "0", 
//              "first_exchdate": "201712", 
//              "fix_state": "A", 
//              "fixcomb_type": "", 
//              "forbid_flag_022": "0", 
//              "forbid_flag_982": "", 
//              "fund_busin_code": "090", 
//              "fund_code": "C40001", 
//              "fund_exceed_flag": "", 
//              "fund_name": "测试基金低风险", 
//              "fund_risk_flag": "", 
//              "fund_status": "0", 
//              "max_succ_times": "0", 
//              "max_trade_succ_quota": "0.00", 
//              "max_value": "999999999999.00", 
//              "min_value": "1.00", 
//              "money_type": "0", 
//              "net_no": "0001", 
//              "next_fixrequest_date": "20171212", 
//              "portfolio_allot_no": "", 
//              "portfolio_code": "", 
//              "protocol_fix_day": "3", 
//              "protocol_name": "", 
//              "protocol_period_unit": "1", 
//              "reg_share": "3774.79", 
//              "rowcount": "1", 
//              "scheduled_protocol_id": "201711102157", 
//              "share_type": "A", 
//              "shares": "0.00", 
//              "sign_date": "", 
//              "success_type": "0", 
//              "ta_acco": "C41000000059", 
//              "target_fund_code": "", 
//              "target_share_type": "", 
//              "tenantid": "519", 
//              "total_cfm_bala": "0.00", 
//              "total_cfm_share": "0.00", 
//              "total_count": "0", 
//              "total_trade_succ_quota": "0.000000000000000000000000", 
//              "total_trade_times": "0", 
//              "trade_acco": "0290", 
//              "trade_period": "1", 
//              "trade_source": "", 
//              "trust_way": "2"
//          }

    mui.plusReady(function(){
        vue_body.fund_code = com.plus.getCurrWebview().self.fund_code;

    	scroll = new com.mui.muiScroll(
            document.querySelector("#station-list")
            , function (index, size, do_success, do_error){
                var param = {
                    current_page:index,
                    num_per_page:5,
                }
//        fund_code:vue_body.fund_code,
                if(vue_body.fund_code!=null){
                    param["fund_code"]=vue_body.fund_code;
                }
                com.data.funds.getDingTouList(param,function (data){

                	if(index==1){
                        vue_body.fundslist = data.result_list;
                        vue_body.isLoad = 1;
                		do_success(1);
                	}else{
                		if(data.result_list!=null){
	                		vue_body.fundslist.push.apply(vue_body.fundslist,data.result_list);
	                		do_success(1);
                		}else{
	                		do_success(0);
                		}
                	}
                },function (data){
//                    alert(data)
                    do_error(0);
                })
            }
        )
        scroll.refresh();
    	
		
		mui('body').on('tap', '.div-ding', function (){
            var scheduled_protocol_id = this.getAttribute("scheduled_protocol_id");
            var trade_acco = this.getAttribute("trade_acco");
//            alert(p1);
//            alert(p2);
            com.plus.openWindowX('dinginfo.html', {
                scheduled_protocol_id:scheduled_protocol_id,
                trade_acco:trade_acco
            });
        });
    })
</script>
</body>

</html>