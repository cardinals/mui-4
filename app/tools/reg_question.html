<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>首页</title>
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
	<link href="../../css/mui.css" rel="stylesheet" />
	<link href="../../css/gloab.css" rel="stylesheet" />
	<link href="../../css/xmui.pullToRefresh.material.css" rel="stylesheet" />
	<link href="../../css/swiper.min.css" rel="stylesheet">
	<style>
		.titlecolor{
			color: white;
		}
		.mui-bar{
			background-color: #D42528;
		}
		
		.mui-input-group .mui-input-row:after{
			height: 0px;
		}
	</style>

</head>
<body>
    <header class="mui-bar mui-bar-nav bg-title">
        <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left color-white"></a>
        <h1 class="mui-title color-white titlecolor">风险测评</h1>
    </header>

<div class="mui-content mui-scroll-wrapper bg-bai">


	<div class="mui-scroll" id="station-list" style="padding-bottom: 50px;">
		<div id="vue-body">
			
			<div>
				<img src="../../images/cp.png" width="100%"/>
			</div>
			<!--题目开始 start-->
			<div v-for="(item,index) in questions.length" class="wd90" style="border-bottom: 1px dashed #999;padding-bottom: 20px;padding-top: 10px;">
				<div style="font-size: 18px;" v-text="item+'、'+questions[index].question_content">
				</div>
				<div v-for="(item2,index2) in questions[index].items.length" class="mui-input-row mui-radio  mui-left">
					<label v-text="questions[index].items[index2].order_no+'、'+questions[index].items[index2].option_content"></label>
					<input :name="item" :value="questions[index].items[index2].order_no" v-model="choice_input[index]" type="radio">
				</div>
			</div>
			

		</div>

	</div>
	<div class="wd100 bottom0" style="margin-top: 30px;position: fixed;z-index: 999;">
		<button type="button" class="" id="next_step" style="width: 100%;height: 40px;background-color: #FFFFFF;color: #FB5C60;border: 1px solid #EEEEEE;">提交</button>
	</div>
</div>


<script src="../../js/h.min.js"></script>
		<script src="../../js/mui.min.js"></script>
		<script src="../../js/immersed.js"></script>
<script src="../../js/com.js"></script>
<script src="../../js/xmui-globalEvent.js"></script>
<script src="../../js/mui.pullToRefresh.js"></script>
<script src="../../js/mui.pullToRefresh.material.js"></script>
<script src="../../js/com.js"></script>
<script src="../../js/com.data.js"></script>
<script src="../../js/com.mui.js"></script>
<script src="../../js/vue.js"></script>
<script src="../../js/jquery.min_1.8.3.js"></script>
<script src="../../js/md5.js"></script>

<script>
    mui.ready(function () {
        mui(".mui-scroll-wrapper").scroll({
            bounce: true,//是否启用回弹
            indicators: true,//是否显示滚动条
            deceleration:  0.0005 //flick 减速系数，系数越大，滚动速度越慢，滚动距离越小，默认值0.0006
        });
    });

    

    mui.plusReady(function(){
    	var vue_body = new Vue({
			el:"#vue-body",
			data:{
				questions:[],
				choice_input:[],
                isalone:false
			}
			,methods:{

			}
			,mounted: function(){
				var logintoken = com.data.loginToken.get();
			   com.data.user.getQuestions({}
				,function(data){
					vue_body.questions = data.result_list;
			   })
			}
		});

        vue_body.isalone = com.plus.getCurrWebview().self.isalone==null?false:com.plus.getCurrWebview().self.isalone;

    	
        mui('body').on('tap', '#card_type', function (){
//      	alert(1);
           	var picker = new mui.PopPicker();
			picker.setData([{value:1,text:'身份证'},{value:2,text:'护照'}]);
			picker.show(function (selectItems){
				document.getElementById("card_type").innerHTML = selectItems[0].text;
				console.log(selectItems[0].text);//智子
				console.log(selectItems[0].value);//zz 
			})
        });
        mui('body').on('tap', '#bron_time', function (){
//      	alert(1);
		    var dtPicker = new mui.DtPicker({type:"date",beginDate:new Date(1900,1),endDate:new Date()}); 
		    dtPicker.show(function (selectItems){
//		    	alert(JSON.stringify(selectItems))
//		    	var y = selectItems.y;//{text: "2016",value: 2016} 
//		        var m = selectItems.m;//{text: "05",value: "05"} 
//		        var d = selectItems.d;//{text: "05",value: "05"} 
		    	document.getElementById("bron_time").innerHTML = selectItems.value;

		    })
        });
        mui('body').on('tap', '#next_step', function (){
//            //测试转跳
//            com.plus.openWindowX('../tools/reg_questresult.html',
//                {
//                    lv:1,
//                    isalone:vue_body.isalone
//                });
//			return


			var questions = vue_body.questions;
			var params = "";
			var hasnull = 0;
			for (var i =0;i<vue_body.questions.length;i++){
				if(!vue_body.choice_input[i]){
					mui.toast("第"+(i+1)+"题还未作答，请答完所有题后再提交。");
					return;
				}
                params += "|"+vue_body.questions[i].question_no+":"+vue_body.choice_input[i];
            }
            
            params = params.substring(1);
//			alert(params);
          	com.data.user.commitAnswer({
                  elig_content:encodeURIComponent(encodeURIComponent(params))
			},function (data) {
//				alert(JSON.stringify(data.result_map.invest_risk_tolerance));
              com.plus.openWindowX('../tools/reg_questresult.html',
				  {
				      lv:data.result_map.invest_risk_tolerance,
					  isalone:vue_body.isalone
				  },"显示结果",function () {
                      com.plus.getCurrWebview().self.close();
                  });
            })

        });
//      mui('body').on('tap', '#jump', function (){
//            com.plus.openWindowX('../home_user.html', {
//            });
//      });
    })
</script>
</body>

</html>