<!DOCTYPE html>
<html>
<head>
	<title>资讯</title>
</head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="stylesheet" type="text/css" href="plug-in/weui/css/weui.min.css">
<link rel="stylesheet" type="text/css" href="plug-in/weui/css/jquery-weui.css">
<link rel="stylesheet" type="text/css" href="plug-in/fonts/iconfont.css">
<link rel="stylesheet" type="text/css" href="css/new.css">
<script type="text/javascript" src="plug-in/jquery1.12.4/jquery.min.js"></script>
<script type="text/javascript" src="plug-in/weui/js/jquery-weui.js"></script>
<script type="text/javascript" src="plug-in/URI1.18.12/URI.js"></script>
<script type="text/javascript" src="js/dataformat.js"></script>
<script type="text/javascript" src="js/common.js"></script>
<script type="text/javascript" src="plug-in/jquery-md5/jquery.md5.js"></script>
<script type="text/javascript">	
	var newsWebURL="";
$(function(){
	getNewsWebURL();
	var cursor = "";
	var html=getMostRead(cursor,"0");
	$("#news_list_div").append(html);
})
//热点新闻
function getMostRead(cursor,auto){
	var html="";
	var url='https://dedicated.wallstreetcn.com/api/v1/fabricate-articles?platform=wscn-platform&channel=most-read&limit=5';
	if(cursor!=""){
		url=url+"&cursor="+cursor;
	}
	$.ajax({
		url : url,
		type : 'get',
		dataType:"JSON",
		async: false,
		data:{},
		success:function(data){
			
			//成功
			if(data.code=="20000"){
				var newsList=data.data.items;
				if(newsList!=null && newsList.length!=0){
					$.each(newsList,function(n,map){
						
						html=html+"<a href=\"javascript:;\" onclick=\"goNewsDetail('"+map.id+"','"+ map.title +"')\" class=\"weui-media-box weui-media-box_appmsg\">";
				     	html=html+"<div class=\"weui-media-box__hd\">";
				        html=html+"<img class=\"weui-media-box__thumb\" src=\""+ map.image_uri +"\">";
				      	html=html+"</div>";
				      	html=html+"<div class=\"weui-media-box__bd\">";
				        html=html+"<h4 class=\"weui-media-box__title\">"+ map.title +"</h4>";
						html=html+"<ul class=\"weui-media-box__info\">";
						html=html+"<li class=\"weui-media-box__info__meta\">"+map.author.display_name+"</li>";
						html=html+"<li class=\"weui-media-box__info__meta weui-media-box__info__meta_extra\">"+ getLocalTime(map.display_time) +"</li>";
						html=html+"</ul>";
				      	html=html+"</div>";
				    	html=html+"</a>";
					});
				}
			}
		}
	});
	return html;
}

function getNewsWebURL(){
	var paras="sys_code=news_web_url";
	paras=setQueryString(paras);
	var url=apiURL+'sysConfController.do?sys_conf_query&'+paras;
	$.ajax({
		url : url,
		type : 'get',
		dataType:"jsonp",
		jsonp: "jsoncallback",
		//jsonpCallback:'jsoncallback', 
		success:function(data){
	
			if("1"==data.success_type){
				var sysCfg=data.result_map["result_list"];
				if(sysCfg!=null && sysCfg.length!=0){
					newsWebURL=sysCfg[0].sysValue;
					if(newsWebURL!=""){
						//$("#calendarLink").attr("href",newsWebURL+"page/livenews/live_news.html"); 
						$("#newsLink").attr("href",newsWebURL+"page/article/articles.html");
					}
				}
			}
		}
	});
}


function goNewsDetail(article_id,title){
	if(newsWebURL!=""){
		title = encodeURIComponent(encodeURIComponent(title));
		windowHref(newsWebURL+'page/article/article_detail.html','article_id='+article_id+'&title='+title);
	}
} 
</script>
<body>
	
	
	
<div class="weui-panel weui-panel_access news_list">
	<div class="weui-panel__hd">热点资讯</div>
    <div class="weui-panel__bd" id="news_list_div">
   
  </div>
  <div class="weui-panel__ft">
    <a class="weui-cell weui-cell_access weui-cell_link" id="newsLink">
      <div class="weui-cell__bd">查看更多</div>
      <span class="weui-cell__ft"></span>
    </a>    
  </div>
</div>
</body>
</html>