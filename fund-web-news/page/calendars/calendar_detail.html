<!DOCTYPE html>
<html>
<head>
	<title>财经日历</title>
</head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="stylesheet" type="text/css" href="../../plug-in/weui/css/weui.min.css">
<link rel="stylesheet" type="text/css" href="../../plug-in/weui/css/jquery-weui.css">
<link rel="stylesheet" type="text/css" href="../../plug-in/fonts/iconfont.css">
<script type="text/javascript" src="../../plug-in/fonts/iconfont.js"></script>
<link rel="stylesheet" type="text/css" href="../../css/new.css">
<script type="text/javascript" src="../../plug-in/jquery1.12.4/jquery.min.js"></script>
<script type="text/javascript" src="../../plug-in/weui/js/jquery-weui.js"></script>
<script type="text/javascript" src="../../js/dataformat.js"></script>
<script type="text/javascript" src="../../plug-in/URI1.18.12/URI.js"></script>
<script type="text/javascript" src="../../js/common.js"></script>
<script type="text/javascript">
	var currentURL=getCurrentURL(document);
	var paraString=getQueryStringValue(currentURL,"paras");
	
	
	paraString=decodeURIComponent(paraString);
	console.log(paraString);
	var virtuaURL=new URI("1.html?"+paraString);
	
	var timestamp=getQueryStringValue(virtuaURL,"timestamp");
	var ticker=getQueryStringValue(virtuaURL,"ticker");
	var country=getQueryStringValue(virtuaURL,"country");
	var flagURL=getQueryStringValue(virtuaURL,"flagURL");
	var stars=getQueryStringValue(virtuaURL,"stars");
	var title=getQueryStringValue(virtuaURL,"title");
	var actual=getQueryStringValue(virtuaURL,"actual");
	var forecast=getQueryStringValue(virtuaURL,"forecast");
	var previous=getQueryStringValue(virtuaURL,"previous");
	//ticker='USPHTMOM Index';
//取得日历详细
function getCalendarDetail(){
	$.ajax({
		url : 'https://api-prod.wallstreetcn.com/apiv1/finfo/ticker/detail',
		type : 'get',
		dataType:"JSON",
		async: false,
		data:{'ticker':ticker},
		success:function(data){
			//成功
			if(data.code=="20000"){
				var calendar=data.data;
				if(calendar!=null){
					
					var html="";
//				    //时间
//					html=html+timestamp;
//					//国家
//					html=html+country;
//					//国旗
//					html=html+flagURL;
//					//星级
//					html=html+stars;
//					//标题
//					html=html+title;
//					//今值
//					html=html+actual;
//					//预期
//					html=html+forecast;
//					//前值
//					html=html+previous;
					

html=html+"<div class=\"rili-list\">";
html=html+"    <div class=\"weui-flex t1\">";
html=html+"        <div class=\"r-time\"><div class=\"placeholder\"><i class=\"iconfont icon-time-o\"></i> "+ timestamp +"</div></div>";
html=html+"       <div class=\"weui-flex__item r-guo\"><div class=\"placeholder\"><img src=\""+ flagURL +"\" class=\"flag\"> "+ country +"</div></div>";
if(stars==1){
	html=html+"        <div class=\"r-xing\"><div class=\"placeholder\">";
	html=html+"        	<svg class=\"icon\" aria-hidden=\"true\" style=\"font-size: 1em;\"><use xlink:href=\"#icon-star\"></use></svg>";
	html=html+"        	<svg class=\"icon\" aria-hidden=\"true\" style=\"font-size: 1em;\"><use xlink:href=\"#icon-xingcopy\"></use></svg>";
	html=html+"        	<svg class=\"icon\" aria-hidden=\"true\" style=\"font-size: 1em;\"><use xlink:href=\"#icon-xingcopy\"></use></svg>";
	html=html+"        </div></div>";
	html=html+"    </div>";
}
if(stars==2){
	html=html+"        <div class=\"r-xing\"><div class=\"placeholder\">";
	html=html+"        	<svg class=\"icon\" aria-hidden=\"true\" style=\"font-size: 1em;\"><use xlink:href=\"#icon-star\"></use></svg>";
	html=html+"        	<svg class=\"icon\" aria-hidden=\"true\" style=\"font-size: 1em;\"><use xlink:href=\"#icon-star\"></use></svg>";
	html=html+"        	<svg class=\"icon\" aria-hidden=\"true\" style=\"font-size: 1em;\"><use xlink:href=\"#icon-xingcopy\"></use></svg>";
	html=html+"        </div></div>";
	html=html+"    </div>";
}
if(stars==3){
	html=html+"        <div class=\"r-xing\"><div class=\"placeholder\">";
	html=html+"        	<svg class=\"icon\" aria-hidden=\"true\" style=\"font-size: 1em;\"><use xlink:href=\"#icon-xing\"></use></svg>";
	html=html+"        	<svg class=\"icon\" aria-hidden=\"true\" style=\"font-size: 1em;\"><use xlink:href=\"#icon-xing\"></use></svg>";
	html=html+"        	<svg class=\"icon\" aria-hidden=\"true\" style=\"font-size: 1em;\"><use xlink:href=\"#icon-xing\"></use></svg>";
	html=html+"        </div></div>";
	html=html+"    </div>";
}
html=html+"    <div class=\"weui-flex t2\">";
html=html+"        <div class=\"weui-flex__item r-title\"><div class=\"placeholder\">"+ title +"</div></div>";
html=html+"    </div>";
html=html+"    <div class=\"weui-flex t3\">";
html=html+"        <div class=\"weui-flex__item r-va1\"><div class=\"placeholder\">今值 <i>"+ actual +"</i></div></div>";
html=html+"        <div class=\"weui-flex__item r-va2\"><div class=\"placeholder\">预期 <i>"+ forecast +"</i></div></div>";
html=html+"        <div class=\"weui-flex__item r-va3\"><div class=\"placeholder\">前值 <i>"+ previous +"</i></div></div>";
html=html+"    </div>";
html=html+"</div>";

					
					$(".rili-box").html(html);
					html="";
					
					
//					 //下次公布时间
//					html=html+getLocalTime(calendar.next_fab_time);
//					//数据公布机构
//					html=html+calendar.public_organization;
//					//发布频率
//					html=html+calendar.release_frequency;
//					//统计方法
//					html=html+calendar.statistical_method;
//					//数据影响
//					html=html+calendar.data_influence;
//					//数据释义
//					html=html+calendar.data_paraphrase;
//					//关注理由
//					html=html+calendar.focus_reason;
					
	
	html=html+"<div class=\"weui-form-preview\">";
	html=html+"<div class=\"weui-form-preview__bd\">";
	html=html+"<div class=\"weui-form-preview__item\">";
	html=html+"<label class=\"weui-form-preview__label\">下次公布时间</label>";
	html=html+"<span class=\"weui-form-preview__value\">"+getLocalTime(calendar.next_fab_time)+"</span>";
	html=html+"</div>";
	html=html+"<div class=\"weui-form-preview__item\">";
	html=html+"<label class=\"weui-form-preview__label\">数据公布机构</label>";
	html=html+"<span class=\"weui-form-preview__value\">"+calendar.public_organization+"</span>";
	html=html+"</div>";
	html=html+"<div class=\"weui-form-preview__item\">";
	html=html+"<label class=\"weui-form-preview__label\">发布频率</label>";
	html=html+"<span class=\"weui-form-preview__value\">"+calendar.release_frequency+"</span>";
	html=html+"</div>";
	html=html+"<div class=\"weui-form-preview__item\">";
	html=html+"<label class=\"weui-form-preview__label\">统计方法</label>";
	html=html+"<span class=\"weui-form-preview__value\">"+calendar.statistical_method+"</span>";
	html=html+"</div>";
	html=html+"</div>";
	html=html+"</div>";
	

	$(".rili-par").html(html);
	html="";
	

    html=html+"<article class=\"weui-article\">";
	html=html+"	<section><h3>数据影响</h3><p>"+calendar.data_influence+"</p></section>";
	html=html+"	 <section><h3>数据释义</h3><p>"+calendar.data_paraphrase+"</p></section>";      
	html=html+"	 <section><h3>关注理由</h3><p>"+calendar.focus_reason+"</p></section>";
	html=html+"</article>";


	$(".detail").html(html);
	html="";




		
			}
			}
		}
	});
	
}
$(function(){
	var endDate=new Date().format("yyyy-MM-dd");
	 var beginDate=addDay(endDate,0-1*365);
	 start=getStartDateTime(beginDate);
	 
	 getCalendarDetail();
	 getHisLine();
});
var start;
function getStartDay(year){
	var endDate=new Date().format("yyyy-MM-dd");
	if("1"==year){
		 var beginDate=addDay(endDate,0-1*365);
		 start=getStartDateTime(beginDate);
	}else if("2"==year){
		var beginDate=addDay(endDate,0-2*365);
		start=getStartDateTime(beginDate);
	}else{
		var beginDate=addDay(endDate,0-3*365);
		start=getStartDateTime(beginDate);
	}
	getHisLine();
}
function getHisLine(){
	var html="";
	var end=new Date().getTime();
	$.ajax({
		url : 'http://api-prod.wallstreetcn.com/apiv1/finfo/ticker/calendar/history',
		type : 'get',
		dataType:"JSON",
		async: false,
		data:{'ticker':ticker,start:'1497311400',end:'1497311401'},
		success:function(data){
			//成功
			if(data.code=="20000"){
				
			}
		}
	});
	return html;
}

</script>
<body>
	
	
	
	
	
	
	
<div class="frame">  



<!-- 头导航 -->
<header class="header-m">
<div class="weui-flex">
  <div class="weui-flex__item hl"><a href="javascript:history.back()"><i class="iconfont icon-back"></i></a></div>
  <div class="weui-flex__item ht">财经日历</div>
  <div class="weui-flex__item hr"></div>
</div>
</header>
<!-- 头导航 //-->
	
	
	
	


<div class="rili-box"></div>


<div class="rili-par"></div>


<div class="detail"></div>


	
</div>  
	
	
	
	
	
	
	
	
	
	
	

</body>
</html>